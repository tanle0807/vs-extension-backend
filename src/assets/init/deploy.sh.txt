#!/usr/bin/env sh

# abort on errors
set -e

echo '====================================================================================='
echo '===================================...DEPLOYING...==================================='
echo '====================================================================================='

npm run build

echo '====================================================================================='
echo '=====================================...BUILD...====================================='
echo '====================================================================================='

# navigate into the build output directory

rm -rf deploy
mkdir deploy
cp -r ./dist ./deploy/dist
cp -r ./package.json ./deploy/package.json
cp -r .env.production ./deploy/.env

cd deploy

git init
git add -A
git commit -m 'deploy'

echo '====================================================================================='
echo '==================================...PUSHING GIT...=================================='
echo '====================================================================================='
git push -f https://link.git master
cd -

rm -rf deploy
rm -rf dist

echo '====================================================================================='
now=$(date +"%T")
echo "=================================...DEPLOY SUCCESS AT $now...================================"
echo '====================================================================================='